!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e=e||self).ReactIntersectionObserver={},e.React)}(this,(function(e,t){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o="Invariant failed";function i(e,t){if(!e)throw new Error(o)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var c=new Map,l=new Map,d=new Map,u=0;function p(e,t,n){void 0===n&&(n={}),n.threshold||(n.threshold=0);var r=n,o=r.root,s=r.rootMargin,a=r.threshold;if(c.has(e)&&i(!1),e){var h=function(e){return e?d.has(e)?d.get(e):(u+=1,d.set(e,u.toString()),d.get(e)+"_"):""}(o)+(s?a.toString()+"_"+s:a.toString()),p=l.get(h);p||(p=new IntersectionObserver(v,n),h&&l.set(h,p));var f={callback:t,element:e,inView:!1,observerId:h,observer:p,thresholds:p.thresholds||(Array.isArray(a)?a:[a])};return c.set(e,f),p.observe(e),f}}function f(e){if(e){var t=c.get(e);if(t){var n=t.observerId,r=t.observer,o=r.root;r.unobserve(e);var i=!1,s=!1;n&&c.forEach((function(t,r){r!==e&&(t.observerId===n&&(i=!0,s=!0),t.observer.root===o&&(s=!0))})),!s&&o&&d.delete(o),r&&!i&&r.disconnect(),c.delete(e)}}}function v(e){e.forEach((function(e){var t=e.isIntersecting,n=e.intersectionRatio,r=e.target,o=c.get(r);if(o&&n>=0){var i=o.thresholds.some((function(e){return o.inView?n>e:n>=e}));void 0!==t&&(i=i&&t),o.inView=i,o.callback(i,e)}}))}var g=function(e){var n,r;function o(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return s(h(t=e.call.apply(e,[this].concat(r))||this),"state",{inView:!1,entry:void 0}),s(h(t),"node",null),s(h(t),"handleNode",(function(e){t.node&&f(t.node),t.node=e||null,t.observeNode()})),s(h(t),"handleChange",(function(e,n){(e!==t.state.inView||e)&&t.setState({inView:e,entry:n}),t.props.onChange&&t.props.onChange(e,n)})),t}r=e,(n=o).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r;var c=o.prototype;return c.componentDidMount=function(){this.node||i(!1)},c.componentDidUpdate=function(e,t){e.rootMargin===this.props.rootMargin&&e.root===this.props.root&&e.threshold===this.props.threshold||(f(this.node),this.observeNode()),t.inView!==this.state.inView&&this.state.inView&&this.props.triggerOnce&&(f(this.node),this.node=null)},c.componentWillUnmount=function(){this.node&&(f(this.node),this.node=null)},c.observeNode=function(){if(this.node){var e=this.props,t=e.threshold,n=e.root,r=e.rootMargin;p(this.node,this.handleChange,{threshold:t,root:n,rootMargin:r})}},c.render=function(){var e=this.state,n=e.inView,r=e.entry;if(!function(e){return"function"!=typeof e.children}(this.props))return this.props.children({inView:n,entry:r,ref:this.handleNode});var o=this.props,i=o.children,s=o.as,h=o.tag,c=(o.triggerOnce,o.threshold,o.root,o.rootMargin,o.onChange,function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(o,["children","as","tag","triggerOnce","threshold","root","rootMargin","onChange"]));return t.createElement(s||h||"div",a({ref:this.handleNode},c),i)},o}(t.Component);function w(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=window),!n)return 0;var r=(n instanceof Element?n.clientHeight:n.innerHeight)||0,o=t*e.height,i=(e.bottom-o)/(r+e.height-2*o);return 1-Math.max(0,Math.min(1,i))}function m(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=window),!n)return 0;var r=(n instanceof Element?n.clientWidth:n.innerWidth)||0,o=t*e.width,i=(e.right-o)/(r+e.width-2*o);return 1-Math.max(0,Math.min(1,i))}function y(e){return"function"!=typeof e.children}s(g,"displayName","InView"),s(g,"defaultProps",{threshold:0,triggerOnce:!1});var b=function(e){var o,i;function s(){for(var t,o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return r(n(t=e.call.apply(e,[this].concat(i))||this),"state",{percentage:0,inView:!1,entry:void 0}),r(n(t),"node",void 0),r(n(t),"monitoring",!1),r(n(t),"handleScroll",(function(){if(t.node){var e=t.node.getBoundingClientRect(),n=t.props.horizontal?m(e,t.props.threshold,t.props.root):w(e,t.props.threshold,t.props.root);n!==t.state.percentage&&t.setState({percentage:n})}})),r(n(t),"handleInView",(function(e,n){t.node=n.target,t.setState({entry:n,inView:e})})),r(n(t),"handleRenderProps",(function(e){var n=e.ref,r=t.state,o=r.percentage,i=r.entry,s=r.inView;return y(t.props)?null:t.props.children({percentage:o,entry:i,inView:s,ref:n})})),t}i=e,(o=s).prototype=Object.create(i.prototype),o.prototype.constructor=o,o.__proto__=i;var a=s.prototype;return a.componentDidUpdate=function(e,t){!this.props.onChange||t.percentage===this.state.percentage&&t.inView===this.state.inView||this.props.onChange(this.state.percentage,this.state.entry),e.root!==this.props.root&&this.monitoring&&(this.monitorScroll(!1,e.root),this.monitorScroll(this.state.inView)),t.inView!==this.state.inView&&this.monitorScroll(this.state.inView,e.root)},a.componentWillUnmount=function(){this.monitorScroll(!1)},a.monitorScroll=function(e,t){var n=t||this.props.root||window;if(e){if(this.monitoring)return;n.addEventListener("scroll",this.handleScroll,{passive:!0}),n.addEventListener("resize",this.handleScroll),this.handleScroll(),this.monitoring=!0}else{if(!this.monitoring)return;n.removeEventListener("scroll",this.handleScroll),n.removeEventListener("resize",this.handleScroll),this.monitoring=!1}},a.render=function(){return t.createElement(g,{onChange:this.handleInView},y(this.props)?this.props.children:this.handleRenderProps)},s}(t.Component);r(b,"displayName","ScrollPercentage"),r(b,"defaultProps",{threshold:0}),e.ScrollPercentage=b,e.default=b,e.useScrollPercentage=function(e){void 0===e&&(e={});var n=function(e){void 0===e&&(e={});var n=t.useRef(),r=t.useState({inView:!1,entry:void 0}),o=r[0],i=r[1],s=t.useCallback((function(t){n.current&&f(n.current),t&&p(t,(function(n,r){i({inView:n,entry:r}),n&&e.triggerOnce&&f(t)}),e),n.current=t}),[e.threshold,e.root,e.rootMargin,e.triggerOnce]);return t.useDebugValue(o.inView),[s,o.inView,o.entry]}(e),r=n[0],o=n[1],i=n[2],s=t.useState(0),a=s[0],h=s[1],c=i&&i.target;return t.useEffect((function(){var t=function(){if(c){var t=c.getBoundingClientRect(),n=e.horizontal?m(t,e.threshold,e.root):w(t,e.threshold,e.root);h(n)}};if(o){var n=e.root||window;return n.addEventListener("scroll",t,{passive:!0}),n.addEventListener("resize",t),function(){n.removeEventListener("scroll",t),n.removeEventListener("resize",t)}}t()}),[o,e.root,e.horizontal,e.threshold,c]),[r,a,i]},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=react-scroll-percentage.umd.min.js.map
